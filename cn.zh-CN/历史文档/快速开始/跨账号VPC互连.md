# 跨账号VPC互连 {#concept_wrx_vbr_ydb .concept}

本教程指引您如何使用高速通道实现跨账号下的两个VPC互通。

## 教程示例 {#section_ock_bcr_ydb .section}

本操作以如下两个VPC为例演示如何使用高速通道实现VPC私网互通。

|配置|账号A|账号B|
|:-|:--|:--|
|VPC ID|vpc-12345678（VPC A）|vpc-87654321（VPC B）|
|地域|华北2（北京）|华东1（杭州）|
|路由器ID|vrt-AAA|1vrt-BBB|
|VPC网段|192.168.0.0/16|172.16.0.0/12|
|交换机网段|192.168.100.0/24|172.16.100.0/24|

## 前提条件 {#section_kdw_xbr_ydb .section}

-   已获取对方的阿里云账号ID和路由器ID。
-   确保要进行互连的VPC或交换机的网段不冲突。

## 步骤一 创建发起端路由器接口 {#section_ldw_xbr_ydb .section}

完成以下操作，为账号A的VPC创建发起端路由器接口：

1.  登录[高速通道管理控制台](https://vpc.console.aliyun.com/expressConnect#/connection/cn-beijing/list)。
2.  在左侧导航栏，单击**专有网络连接** \> **路由器接口**。
3.  在路由器接口页面右上角，单击**创建路由器接口**。
4.  配置路由器接口。

    本操作使用如下配置：

    -   **连接场景**：选择**VPC互连**。

    -   **创建路由器场景**：选择**只创建发起端**。

    -   **地域**：选择本端VPC的所属地域，本操作中选择**华北2\(北京\)**。

    -   **本端VPC ID**：选择发起端的VPC，本操作中选择VPC A的ID。

    -   **对端地域**：选择要连接的VPC的所属地域，本操作中选择**华东1\(杭州\)**。

    -   **规格**：选择发起端路由器接口的规格，本操作中选择**大型1档**。

5.  单击**立即购买**，完成创建

    大约一分钟后，返回路由器接口列表页面。选择华北2\(北京\)地域，即可看到账号A的路由器接口。为方便表示，本操作中以ri-AAA表示账号A的路由器接口ID。


## 步骤二 创建接受端路由器接口 {#section_npq_lgr_ydb .section}

完成以下操作，为账号B的VPC创建接受端路由器接口：

1.  登录[高速通道管理控制台](https://vpc.console.aliyun.com/expressConnect#/connection/cn-beijing/list)。
2.  在左侧导航栏，单击**专有网络连接** \> **路由器接口**。
3.  在路由器接口页面右上角，单击**创建路由器接口**。
4.  配置路由器接口。

    本操作使用如下配置：

    -   **连接场景**：选择**VPC互连**。

    -   **创建路由器场景**：选择**只创建接受端**。

    -   **地域**：选择本端VPC的所属地域，本操作中选择**华东1\(杭州\)**。

    -   **本端VPC ID**：选择接收端路由器接口所在的VPC，本操作中选择VPC B的ID。

    -   **对端地域**：选择要连接的VPC的所属地域，本操作中选择**华北2\(北京\)**。

5.  单击**立即购买**，完成创建。

    大约一分钟后，返回路由器接口列表页面。选择华东1\(杭州\)地域，即可看到账号B的路由器接口。为方便表示，本操作中以ri-BBB表示账号B的路由器接口ID。


## 步骤三 添加对端路由器接口并发起连接 {#section_b4x_zgr_ydb .section}

完成以下操作，在两侧的路由器接口中添加对端路由器接口并发起连接：

1.  登录[高速通道管理控制台](https://vpc.console.aliyun.com/expressConnect#/connection/cn-beijing/list)。
2.  在左侧导航栏，单击**专有网络连接** \> **路由器接口**。
3.  在路由器接口列表页面，单击路由器接口ri-BBB**操作**列下的**更多** \> **编辑对端路由器接口信息**。
4.  在弹出的对话框中，根据以下信息为账号B配置对端路由器接口：
    -   **对端账号ID**：对端账号ID。在本操作中输入账号A。

    -   **对端路由器ID**：对端路由器ID。在本操作中输入vrt-AAA。

    -   **对端路由器接口ID**：对端路由器接口ID。在本操作中输入ri-AAA。

5.  重复以上步骤，为账号A为配置对端路由器接口。
6.  返回路由器接口列表页面，在路由器接口ri-AAA的**操作**列下的**更多** \> **发起连接**。当两个账号下的路由器接口ri-AAA和ri-BBB的状态为**已激活**时，表示连接成功。

## 步骤四 配置路由 {#section_tdw_xbr_ydb .section}

创建路由器接口后，完成以下操作为两端的VPC配置路由：

1.  在路由器接口列表页面，找到目标路由器接口，然后单击**路由配置**。
2.  在虚拟路由器列表页面，单击**添加路由**。
3.  在弹出的对话框中，配置路由：
    -   **目标网段**：输入对端进行通信的VPC或交换机的网段。
    -   **下一跳类型**：选择**路由器接口**。
    -   **路由器接口**：选择**普通路由**并选择路由器接口。
4.  重复上述步骤，为另外一个路由器接口关联的VPC配置路由。

    本操作中的路由配置如下表所示。

    |目标网段|下一跳|说明|
    |:---|:--|:-|
    |172.16.100.0/24（VPC B的交换机网段）|VPC A的路由器接口|VPC A的路由表配置|
    |192.168.100.0/24（VPC A的交换机网段）|VPC B的路由器接口|VPC B的路由表配置|


## 步骤五 配置安全组 {#section_zx1_ndf_hfb .section}

在两个VPC间建立对等连接后，可以通过跨账号授权的方式配置安全组规则，实现两个VPC内的ECS实例间的访问控制。

本操作以下表中的ECS实例和安全组配置为例。

|配置信息|账号A|账号B|
|:---|:--|:--|
|账号ID|AccountID\_A|AccountID\_B|
|ECS实例例ID|InstanceID\_A|InstanceID\_B|
|安全组ID|SecurityGroupID\_A|SecurityGroupID\_B|

您可以在[账号中心](https://account.console.aliyun.com/?spm=5176.2020520001.aliyun_topbar.39.4cb94bd3LoJmJ3#/secure)查看账号ID。

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/21767/154349627013076_zh-CN.png)

完成以下操作，配置安全组规则：

1.  登录[云服务器ECS管理控制台](https://ecs.console.aliyun.com/#/home)。
2.  在左侧导航栏，单击**网络和安全** \> **安全组**。
3.  选择实例的地域。
4.  找到目标安全组，然后单击**配置规则**。
5.  在安全组规则页面，单击**添加安全组规则**。
6.  配置安全组规则，根据您的需要选择协议类型并输入端口。

    **说明：** 如果是跨地域VPC互通，选择地址段访问方式，输入对端VPC的网段。

    如果选择安全组访问方式，确保VPC地域相同。如果选择并安全组授权方式，选择**跨账号授权**，账号ID请输入对端账号的ID。

    本操作中选择IP地址段访问方式。


